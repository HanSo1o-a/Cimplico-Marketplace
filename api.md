# WorkpaperMarket API 文档

**更新时间：2025-04-22**

---

## 认证与权限说明
- 绝大多数写操作（如创建、修改、审核等）需要用户登录，并具备相应角色（如供应商、管理员）。
- 普通用户、供应商、管理员权限不同，部分接口仅管理员可用。

---

## 供应商相关

### 创建供应商
- `POST /api/vendors`
- 说明：将当前用户升级为供应商，并创建供应商资料。
- 权限：登录用户
- 请求体：`{ companyName, businessNumber, website?, description? }`
- 返回：供应商资料对象

### 更新供应商资料
- `PUT /api/vendors/:id`
- 说明：更新指定供应商资料。
- 权限：供应商本人或管理员
- 请求体：部分供应商字段
- 返回：更新后的供应商资料

### 获取所有供应商（仅管理员）
- `GET /api/vendors/all`
- 说明：获取所有供应商及其用户信息。
- 权限：管理员
- 返回：供应商数组

### 获取待审核供应商列表（仅管理员）
- `GET /api/admin/vendors/pending`
- `GET /api/vendors/pending`
- 说明：获取所有待审核供应商及其用户信息。
- 权限：管理员
- 返回：供应商数组

### 审核供应商（仅管理员）
- `PATCH /api/admin/vendors/:id`
- 说明：更新供应商审核状态及原因。
- 权限：管理员
- 请求体：`{ verificationStatus, rejectionReason? }`
- 返回：更新后的供应商资料

### 批准/拒绝供应商（仅管理员）
- `POST /api/vendors/:id/approve`
- `POST /api/vendors/:id/reject`
- 说明：批准或拒绝供应商。
- 权限：管理员
- 请求体（拒绝时）：`{ reason }`
- 返回：更新后的供应商资料

### 获取认证供应商列表
- `GET /api/vendors`
- 说明：获取所有已认证供应商及其用户信息和商品数量。
- 权限：公开
- 返回：供应商数组

### 获取指定供应商资料
- `GET /api/vendors/:id`
- 说明：获取指定供应商资料、用户信息和商品列表。
- 权限：公开
- 返回：供应商对象

---

## 商品（Listing）相关

### 获取商品列表
- `GET /api/listings`
- 说明：获取所有商品，按创建时间倒序。
- 权限：公开
- 返回：商品数组

### 获取待审核商品列表
- `GET /api/listings/pending`
- 说明：获取所有待审核商品。
- 权限：公开/管理员（视实现）
- 返回：商品数组

### 获取特色商品
- `GET /api/listings/featured`
- 说明：获取特色商品（可传 `limit` 参数，默认4），附带供应商和用户信息。
- 权限：公开
- 返回：商品数组

### 获取商品详情
- `GET /api/listings/:id`
- 说明：获取商品详情、供应商、评论、是否已收藏等。
- 权限：公开
- 返回：商品对象

### 创建商品（供应商）
- `POST /api/vendors/:vendorId/listings`
- 说明：供应商创建商品。
- 权限：供应商本人或管理员
- 请求体：商品字段
- 返回：商品对象

---

## 分类相关

### 获取所有分类
- `GET /api/categories`
- 说明：获取所有商品分类。
- 权限：公开
- 返回：分类数组

### 获取分类详情
- `GET /api/categories/:id`
- 说明：获取指定分类信息。
- 权限：公开
- 返回：分类对象

---

## 用户相关

### 获取当前用户信息
- `GET /api/me`
- 说明：获取当前登录用户信息。
- 权限：登录用户
- 返回：用户对象

### 获取当前用户供应商资料
- `GET /api/me/vendor`
- 说明：获取当前用户的供应商资料。
- 权限：供应商
- 返回：供应商对象

---

## 评价（评论）相关

### 获取商品评论
- `GET /api/listings/:id/comments`
- 说明：获取指定商品的所有评论。
- 权限：公开
- 返回：评论数组

---

## 其它

### 获取用户收藏的商品
- `GET /api/user/saved-listings`
- 说明：获取当前用户收藏的所有商品。
- 权限：登录用户
- 返回：商品数组

### 获取首页用户评价（Testimonials）
- `GET /api/testimonials`
- 说明：获取首页展示的用户评价。
- 权限：公开
- 返回：评价数组

---

## 备注
- 具体字段结构请参考实际接口返回。
- 所有接口均返回标准 JSON 格式，错误时包含 message 字段。
- 需要登录的接口请携带有效 Cookie/session。
